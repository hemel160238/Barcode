<!DOCTYPE html>
<html>

<head>
    <title>Make Purchase</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"
        defer></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"
        defer></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
        integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"
        defer></script>

</head>

<body>
    <h1>Choose Student</h1>

    <div>
        <div>
            <input id="productIn" type="text" class="form-control" name="productId" placeholder="Student Id">
            <button type="button" id="addItemButton" onclick="myFunction()" class="btn btn-success">Choose Student</button>
        </div>

    </div>
    <div>
        <form>
            <fieldset disabled>
                <div class="form-group">
                    <label for="disabledTextInput">Id</label>
                    <input type="text" id="disabledId" class="form-control" placeholder="ID">
                </div>
                <div class="form-group">
                    <label for="disabledTextInput">Name</label>
                    <input type="text" id="disabledName" class="form-control" placeholder="Name">
                </div>
                <div class="form-group">
                    <label for="disabledTextInput">Email</label>
                    <input type="text" id="disabledEmail" class="form-control" placeholder="Email">
                </div>
                <div class="form-group">
                    <label for="disabledTextInput">Credit</label>
                    <input type="text" id="disabledCredit" class="form-control" placeholder="Credit">
                </div>
            </fieldset>
        </form>
    </div>

    <script>

        // Get the input field
        var input = document.getElementById("productIn");


        // Execute a function when the user releases a key on the keyboard
        input.addEventListener("keyup", function (event) {
            // Number 13 is the "Enter" key on the keyboard
            if (event.keyCode === 13) {
                // Cancel the default action, if needed
                event.preventDefault();
                // Trigger the button element with a click
                document.getElementById("addItemButton").click();

                document.getElementById("productIn").value = "";
            }
        });
        function myFunction() {
            var productId = document.getElementById("productIn").value;
            var http = new XMLHttpRequest();
            var url = 'student.php';
            var params = 'studentId=' + productId;
            http.open('POST', url, true);

            //Send the proper header information along with the request
            http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

            http.onreadystatechange = function () {//Call a function when the state changes.
                if (http.readyState == 4 && http.status == 200) {

                    var response = http.responseText;
                    //alert(response);
                    var obj = JSON.parse(response)[0];

                    if(obj){
                        document.getElementById("disabledId").value = obj['id'];
                        document.getElementById("disabledName").value = obj['first_name']+" "+obj['last_name'];
                        document.getElementById("disabledEmail").value = obj['email'];
                        document.getElementById("disabledCredit").value = obj['credit'];
                    }

                    else {
                        document.getElementById("disabledId").value = "";
                        document.getElementById("disabledName").value = "";
                        document.getElementById("disabledEmail").value = "";
                        document.getElementById("disabledCredit").value = "";
                        alert("Student Not Found !");
                    }

                    

                }
            }
            http.send(params);
        }

        function removeItem(btn) {
            var row = btn.parentNode.parentNode;
            row.parentNode.removeChild(row);
        }
    </script>
</body>

</html>